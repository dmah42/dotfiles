#!/bin/bash

mkdir -p ~/.pulse

ls ~/.pulse/volume &> /dev/null
if [[ $? != 0 ]]
then
	echo "65536" > ~/.pulse/volume
fi

CURVOL=$(cat ~/.pulse/volume)
VOLDELTA=6535

if [[ $1 == "mute" ]]; then
	pactl set-sink-mute 0 toggle
else
	if [[ $1 == "up" ]]; then
		CURVOL=$(($CURVOL + $VOLDELTA))
		if [[ $CURVOL -ge 65536 ]]; then
			CURVOL=65536
		fi
	elif [[ $1 == "down" ]]; then
		CURVOL=$(($CURVOL - $VOLDELTA))
		if [[ $CURVOL -le 0 ]]; then
			CURVOL=0
		fi
  else
    exit
	fi
	pactl set-sink-volume 0 $CURVOL
	echo $CURVOL > ~/.pulse/volume
	# unmute on volume key press
	pactl set-sink-mute 0 0
	echo 0 > ~/.pulse/mute
fi

paplay /usr/share/sounds/freedesktop/stereo/audio-volume-change.oga
